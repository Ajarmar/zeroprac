<?xml version="1.0"?>
<!DOCTYPE binary_file_format SYSTEM "BinaryFileFormat.dtd">
<binary_file_format name="DBX" type_name="" comment="Microsoft Outlook Express .DBX file" default_byte_order="little" default_read_only="true" default_char_set="ansi" web_site="http://oedbx.Aroh.de/" allow_editing="false">
	<struct name="file_header" type_name="" comment=""><data type="int" name="magic" format="unsigned" len="4" domain="this == 0xFE12ADCF" display="hex"/><data type="int" name="flag" format="unsigned" len="1" domain="{OFFLINE=48, MESSAGES=197, FOLDERS, POP3UIDL }" display="" comment="Seems to be the first byte of a CLSID but can be used to distinguish the different file types."/><data type="none" name="fill1" len="0x17"/><data type="int" name="file_info_size" format="unsigned" len="4" display=""/><data type="none" name="fill2" len="0x54 - 0x20"/><data type="int" name="space_used" format="unsigned" len="4" display=""/><data type="int" name="space_reuse" format="unsigned" len="4" display=""/><data type="none" name="fill3" len="0x88 - 0x5C"/><data type="int" name="ptr_message_cond" format="unsigned" len="4" display="hex"/><data type="int" name="ptr_folder_cond" format="unsigned" len="4" display="hex"/><data type="none" name="fill4" len="0x27C - 0x90"/><data type="int" name="space_indexed" format="unsigned" len="4" display="" comment="used space for indexed info objects"/><data type="int" name="used_conditions" format="unsigned" len="4" display="" comment="used space for conditions objects"/><data type="none" name="fill5" len="4"/><data type="int" name="used_folder" format="unsigned" len="4" display="" comment="used space for folder list objects"/><data type="int" name="used_tree" format="unsigned" len="4" display="" comment="used space for tree objects"/><data type="int" name="used_message" format="unsigned" len="4" display="" comment="used space for message objects"/><for name="deleted_object" count="2048" stop_test="" type_name="" comment="Each int4 value points to a single linked list of deleted objects from the variable segments. The objects in each list have the same size : address of the pointer - 0x29c"><data type="int" name="" format="unsigned" len="4" display=""/></for><data type="none" name="fill6" len="0x24BC - 0x2294"/></struct><if test="file_header.flag == 197" comment=""><struct name="message_file_info" type_name="" comment=""><data type="int" name="fill1" format="signed" len="4" display=""/><data type="int" name="type" format="unsigned" len="1" domain="{News, LocalStore=3}" display=""/><data type="string" name="reg_key" format="ascii" len="256" display=""/><data type="string" name="folder_name" format="ascii" len="256" display=""/><data type="none" name="fill2" len="addressof(message_file_info) + file_header.file_info_size - addressof(folder_name) - sizeof(folder_name)" comment="Just fills to size of file_info_size"/></struct></if><if test="file_header.flag == 198" comment=""><struct name="folders_file_info" type_name="" comment=""><data type="date" name="created" format="filetime" display=""/><data type="none" name="fill" len="256"/></struct></if><for name="segment" count="2" stop_test="" type_name="" comment=""><struct name="" type_name="" comment=""><data type="int" name="marker" format="unsigned" len="4" display="hex"/><if test="addressof(marker) == file_header.ptr_folder_cond || addressof(marker) == file_header.ptr_message_cond" comment=""><struct name="conditions" type_name="" comment=""><data type="int" name="len" format="unsigned" len="4" display=""/><data type="string" name="cond_str" format="ascii" len="len" display=""/></struct></if></struct></for><data type="none" name="none"/>
</binary_file_format>
